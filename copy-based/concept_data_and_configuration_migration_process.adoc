---
permalink: copy-based/concept_data_and_configuration_migration_process.html 
sidebar: sidebar 
keywords: ontap, copy, based, transition, data, configuration, migration, process 
summary: 使用7-Mode Transition Tool的資料與組態移轉程序包含下列階段：準備、基礎資料複製、套用組態（預先轉換）、以及儲存設備轉換。如果SnapLock 您有驗證保管鏈的功能、則保管鏈驗證是轉換後的另一個階段。 
---
= 資料與組態移轉程序
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
使用7-Mode Transition Tool的資料與組態移轉程序包含下列階段：準備、基礎資料複製、套用組態（預先轉換）、以及儲存轉換。如果SnapLock 您有驗證保管鏈的功能、則保管鏈驗證是轉換後的另一個階段。

下圖顯示移轉程序的不同階段：

image::../media/transition_operational_flow.gif[轉換作業流程]



== 準備

在此階段、會執行預先檢查以驗證功能功能。此程序會檢查7-Mode儲存系統、確認磁碟區和組態已準備好移轉至ONTAP VMware。它會檢查叢集的設定是否正確、並可支援移轉作業。任何錯誤都必須先解決、才能繼續進行轉換。雖然此工具可讓您在不解決警告的情況下繼續使用、但您必須先瞭解警告的影響、才能繼續進行轉換。您可以多次執行預先檢查、以確認所有錯誤都已解決。

雖然在評估期間所執行的預先檢查步驟和評估步驟似乎類似、但仍有差異。預先檢查步驟是一項更詳細的測試、著重於識別為移轉來源（7-Mode）ONTAP 和目的地（VMware）系統的特定儲存系統。評估步驟僅評估移轉來源系統、並使用ONTAP 效益分析功能差異。



== 基礎資料複本

在SVM上建立新磁碟區、在7-Mode和ONTAP VMware Volume之間建立SnapMirror關係、並執行基礎傳輸。完成基準後、會根據使用者定義的資料複製排程自動執行遞增傳輸。存取來源儲存設備的用戶端和伺服器在完成此步驟時仍會保持連線。

複製資料需要CPU、記憶體和儲存設備存取、因此會在來源儲存系統上使用額外的資源。最佳做法是排定資料複製活動在非尖峰時間進行（最好是CPU使用率應約為50%）。



== 套用組態（預先轉換）

此階段包括SnapMirror遞增傳輸；組態資訊會套用至ONTAP 整個系統、SVM和Volume。或者、您也可以在ONTAP 儲存設備轉換之前測試正在轉換的等量資料。

雖然會套用大部分的組態、但有些動作會延後至儲存設備轉換：例如、套用配額。

為轉換所選取的7-Mode IP位址會以系統管理的當機狀態建立。為轉換所選取的新IP位址會以系統管理的UP狀態建立。這些新的IP位址可用於在預先轉換測試期間驗證資料存取。

最佳實務做法是在計畫的轉換時間之前、先執行套用組態（預先轉換）階段數天或數週。本練習有助於驗證是否已正確套用所有組態、以及是否需要進行任何變更。


TIP: 雖然不需要遞增更新、但最佳做法是盡可能在儲存轉換的附近執行遞增傳輸、以盡量縮短用戶端中斷連線的時間。



== 儲存設備轉換

在儲存設備轉換期間、用戶端會中斷連線、最後執行資料傳輸、SnapMirror關係中斷、用戶端會手動重新連線。

中斷用戶端或伺服器與來源儲存磁碟區的連線、可防止在執行最終複本時執行其他寫入作業。在中斷用戶端連線之前、最佳做法是執行遞增更新、以將停機時間減至最低。

儲存存取必須僅針對要移轉的磁碟區中斷連線。儲存設備的存取可從儲存設備端或用戶端中斷。最佳實務做法是中斷儲存端的連線。例如、如果CIFS用戶端正在7-Mode儲存系統上存取名為「user01」的磁碟區、您可以使用「CIFS終止-v user01」命令來停用對磁碟區上所有CIFS共用的存取（停止從儲存端存取用戶端）。IP位址、掛載點甚至共用名稱可能會因為移轉而變更、因此用戶端存取也可能中斷。只要用戶端無法將任何新資料寫入正在移轉的儲存容器、您就可以使用其中一種或兩種方法來終止存取。

在用戶端中斷連線之後、7-Mode Transition Tool會執行最終複本、使來源和目的地資料集都達到同位元。7-Mode Transition Tool會在SVM上設定資料生命週期。在預先轉換期間未轉換的部分組態變更、例如套用SAN組態和配額、目前也會套用至SVM。

儲存設備轉換完成後、您可以手動重新連線用戶端、並驗證資料存取。驗證資料存取需要驗證用戶端是否正確存取ONTAP 了這個功能、以及所有權限是否正常運作。



== 驗證鏈驗證資料以驗SnapLock 證資料

您可以在SnapLock 轉換完成後、觸發專案中的流程管理作業、以處理項目中的各個流程。這項作業並非強制性、只有在驗證保管鏈對SnapLock 移轉過程至關重要時才需要。您可以對SnapLock 專案中的所有資料集或SnapLock 專案中的部分資料集執行此作業。法規遵循與企業SnapLock 版的資料不受監管鏈驗證的支援。監管鏈驗證僅支援讀寫SnapLock 能力驗證、不支援唯讀SnapLock 功能的功能。


IMPORTANT: 不支援SnapLock 將檔案名稱與非Ascii字元一起使用的現象驗證鏈驗證。

驗證工作流程僅在7-Mode Transition Tool GUI中受支援、而且CLI工作流程不支援。

監管鏈驗證作業執行下列作業：

* 列舉7-Mode磁碟區的所有WORM檔案
* 計算先前在7-Mode Volume和轉換ONTAP 的VMware Volume上列舉的每個WORM檔案的指紋
* 產生一份報告、詳細說明有相符和不相符指紋的檔案數量、以及不相符的原因


所有WORM檔案的指紋資料都儲存在ONTAP 規劃階段所提供的一套功能不全的資料中。


NOTE: 根據7-Mode磁碟區上的檔案數量、監管鏈驗證程序可能需要相當長的時間（天或週）。
